Enumerable=function(){var t=function(t){this.GetEnumerator=t};t.Choice=function(){var e=arguments[0]instanceof Array?arguments[0]:arguments;return new t(function(){return new i(n.Blank,function(){return this.Yield(e[Math.floor(Math.random()*e.length)])},n.Blank)})},t.Cycle=function(){var e=arguments[0]instanceof Array?arguments[0]:arguments;return new t(function(){var t=0;return new i(n.Blank,function(){return t>=e.length&&(t=0),this.Yield(e[t++])},n.Blank)})},t.Empty=function(){return new t(function(){return new i(n.Blank,function(){return!1},n.Blank)})},t.From=function(u){if(null==u)return t.Empty();if(u instanceof t)return u;if(typeof u==e.Number||typeof u==e.Boolean)return t.Repeat(u,1);if(typeof u==e.String)return new t(function(){var t=0;return new i(n.Blank,function(){return t<u.length?this.Yield(u.charAt(t++)):!1},n.Blank)});if(typeof u!=e.Function){if(typeof u.length==e.Number)return new c(u);if(!(u instanceof Object)&&r.IsIEnumerable(u))return new t(function(){var t,e=!0;return new i(function(){t=new Enumerator(u)},function(){return e?e=!1:t.moveNext(),t.atEnd()?!1:this.Yield(t.item())},n.Blank)})}return new t(function(){var t=[],e=0;return new i(function(){for(var n in u)u[n]instanceof Function||t.push({Key:n,Value:u[n]})},function(){return e<t.length?this.Yield(t[e++]):!1},n.Blank)})},t.Return=function(n){return t.Repeat(n,1)},t.Matches=function(e,r,u){return null==u&&(u=""),r instanceof RegExp&&(u+=r.ignoreCase?"i":"",u+=r.multiline?"m":"",r=r.source),-1===u.indexOf("g")&&(u+="g"),new t(function(){var t;return new i(function(){t=new RegExp(r,u)},function(){var n=t.exec(e);return n?this.Yield(n):!1},n.Blank)})},t.Range=function(n,e,r){return null==r&&(r=1),t.ToInfinity(n,r).Take(e)},t.RangeDown=function(n,e,r){return null==r&&(r=1),t.ToNegativeInfinity(n,r).Take(e)},t.RangeTo=function(n,e,r){return null==r&&(r=1),e>n?t.ToInfinity(n,r).TakeWhile(function(t){return e>=t}):t.ToNegativeInfinity(n,r).TakeWhile(function(t){return t>=e})},t.Repeat=function(e,r){return null!=r?t.Repeat(e).Take(r):new t(function(){return new i(n.Blank,function(){return this.Yield(e)},n.Blank)})},t.RepeatWithFinalize=function(n,e){return n=r.CreateLambda(n),e=r.CreateLambda(e),new t(function(){var t;return new i(function(){t=n()},function(){return this.Yield(t)},function(){null!=t&&(e(t),t=null)})})},t.Generate=function(e,u){return null!=u?t.Generate(e).Take(u):(e=r.CreateLambda(e),new t(function(){return new i(n.Blank,function(){return this.Yield(e())},n.Blank)}))},t.ToInfinity=function(e,r){return null==e&&(e=0),null==r&&(r=1),new t(function(){var t;return new i(function(){t=e-r},function(){return this.Yield(t+=r)},n.Blank)})},t.ToNegativeInfinity=function(e,r){return null==e&&(e=0),null==r&&(r=1),new t(function(){var t;return new i(function(){t=e+r},function(){return this.Yield(t-=r)},n.Blank)})},t.Unfold=function(e,u){return u=r.CreateLambda(u),new t(function(){var t,r=!0;return new i(n.Blank,function(){return r?(r=!1,t=e,this.Yield(t)):(t=u(t),this.Yield(t))},n.Blank)})},t.prototype={CascadeBreadthFirst:function(n,e){var u=this;return n=r.CreateLambda(n),e=r.CreateLambda(e),new t(function(){var o,a=0,s=[];return new i(function(){o=u.GetEnumerator()},function(){for(;;){if(o.MoveNext())return s.push(o.Current()),this.Yield(e(o.Current(),a));var u=t.From(s).SelectMany(function(t){return n(t)});if(!u.Any())return!1;a++,s=[],r.Dispose(o),o=u.GetEnumerator()}},function(){r.Dispose(o)})})},CascadeDepthFirst:function(n,e){var u=this;return n=r.CreateLambda(n),e=r.CreateLambda(e),new t(function(){var o,a=[];return new i(function(){o=u.GetEnumerator()},function(){for(;;){if(o.MoveNext()){var u=e(o.Current(),a.length);return a.push(o),o=t.From(n(o.Current())).GetEnumerator(),this.Yield(u)}if(a.length<=0)return!1;r.Dispose(o),o=a.pop()}},function(){try{r.Dispose(o)}finally{t.From(a).ForEach(function(t){t.Dispose()})}})})},Flatten:function(){var e=this;return new t(function(){var u,o=null;return new i(function(){u=e.GetEnumerator()},function(){for(;;){if(null!=o){if(o.MoveNext())return this.Yield(o.Current());o=null}if(u.MoveNext()){if(u.Current()instanceof Array){r.Dispose(o),o=t.From(u.Current()).SelectMany(n.Identity).Flatten().GetEnumerator();continue}return this.Yield(u.Current())}return!1}},function(){try{r.Dispose(u)}finally{r.Dispose(o)}})})},Pairwise:function(n){var e=this;return n=r.CreateLambda(n),new t(function(){var t;return new i(function(){t=e.GetEnumerator(),t.MoveNext()},function(){var e=t.Current();return t.MoveNext()?this.Yield(n(e,t.Current())):!1},function(){r.Dispose(t)})})},Scan:function(n,e,u){if(null!=u)return this.Scan(n,e).Select(u);var o;null==e?(e=r.CreateLambda(n),o=!1):(e=r.CreateLambda(e),o=!0);var a=this;return new t(function(){var t,u,s=!0;return new i(function(){t=a.GetEnumerator()},function(){if(s){if(s=!1,o)return this.Yield(u=n);if(t.MoveNext())return this.Yield(u=t.Current())}return t.MoveNext()?this.Yield(u=e(u,t.Current())):!1},function(){r.Dispose(t)})})},Select:function(n){var e=this;return n=r.CreateLambda(n),new t(function(){var t,u=0;return new i(function(){t=e.GetEnumerator()},function(){return t.MoveNext()?this.Yield(n(t.Current(),u++)):!1},function(){r.Dispose(t)})})},SelectMany:function(n,e){var u=this;return n=r.CreateLambda(n),null==e&&(e=function(t,n){return n}),e=r.CreateLambda(e),new t(function(){var o,a=void 0,s=0;return new i(function(){o=u.GetEnumerator()},function(){if(void 0===a&&!o.MoveNext())return!1;do{if(null==a){var u=n(o.Current(),s++);a=t.From(u).GetEnumerator()}if(a.MoveNext())return this.Yield(e(o.Current(),a.Current()));r.Dispose(a),a=null}while(o.MoveNext());return!1},function(){try{r.Dispose(o)}finally{r.Dispose(a)}})})},Where:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t,u=0;return new i(function(){t=e.GetEnumerator()},function(){for(;t.MoveNext();)if(n(t.Current(),u++))return this.Yield(t.Current());return!1},function(){r.Dispose(t)})})},OfType:function(t){var n;switch(t){case Number:n=e.Number;break;case String:n=e.String;break;case Boolean:n=e.Boolean;break;case Function:n=e.Function;break;default:n=null}return null===n?this.Where(function(n){return n instanceof t}):this.Where(function(t){return typeof t===n})},Zip:function(n,e){e=r.CreateLambda(e);var u=this;return new t(function(){var o,a,s=0;return new i(function(){o=u.GetEnumerator(),a=t.From(n).GetEnumerator()},function(){return o.MoveNext()&&a.MoveNext()?this.Yield(e(o.Current(),a.Current(),s++)):!1},function(){try{r.Dispose(o)}finally{r.Dispose(a)}})})},Join:function(e,u,o,a,s){u=r.CreateLambda(u),o=r.CreateLambda(o),a=r.CreateLambda(a),s=r.CreateLambda(s);var c=this;return new t(function(){var f,l,h=null,v=0;return new i(function(){f=c.GetEnumerator(),l=t.From(e).ToLookup(o,n.Identity,s)},function(){for(;;){if(null!=h){var t=h[v++];if(void 0!==t)return this.Yield(a(f.Current(),t));t=null,v=0}if(!f.MoveNext())return!1;var n=u(f.Current());h=l.Get(n).ToArray()}},function(){r.Dispose(f)})})},GroupJoin:function(e,u,o,a,s){u=r.CreateLambda(u),o=r.CreateLambda(o),a=r.CreateLambda(a),s=r.CreateLambda(s);var c=this;return new t(function(){var f=c.GetEnumerator(),l=null;return new i(function(){f=c.GetEnumerator(),l=t.From(e).ToLookup(o,n.Identity,s)},function(){if(f.MoveNext()){var t=l.Get(u(f.Current()));return this.Yield(a(f.Current(),t))}return!1},function(){r.Dispose(f)})})},All:function(t){t=r.CreateLambda(t);var n=!0;return this.ForEach(function(e){return t(e)?void 0:(n=!1,!1)}),n},Any:function(t){t=r.CreateLambda(t);var n=this.GetEnumerator();try{if(0==arguments.length)return n.MoveNext();for(;n.MoveNext();)if(t(n.Current()))return!0;return!1}finally{r.Dispose(n)}},Concat:function(n){var e=this;return new t(function(){var u,o;return new i(function(){u=e.GetEnumerator()},function(){if(null==o){if(u.MoveNext())return this.Yield(u.Current());o=t.From(n).GetEnumerator()}return o.MoveNext()?this.Yield(o.Current()):!1},function(){try{r.Dispose(u)}finally{r.Dispose(o)}})})},Insert:function(n,e){var u=this;return new t(function(){var o,a,s=0,c=!1;return new i(function(){o=u.GetEnumerator(),a=t.From(e).GetEnumerator()},function(){return s==n&&a.MoveNext()?(c=!0,this.Yield(a.Current())):o.MoveNext()?(s++,this.Yield(o.Current())):!c&&a.MoveNext()?this.Yield(a.Current()):!1},function(){try{r.Dispose(o)}finally{r.Dispose(a)}})})},Alternate:function(n){return n=t.Return(n),this.SelectMany(function(e){return t.Return(e).Concat(n)}).TakeExceptLast()},Contains:function(t,n){n=r.CreateLambda(n);var e=this.GetEnumerator();try{for(;e.MoveNext();)if(n(e.Current())===t)return!0;return!1}finally{r.Dispose(e)}},DefaultIfEmpty:function(n){var e=this;return new t(function(){var t,u=!0;return new i(function(){t=e.GetEnumerator()},function(){return t.MoveNext()?(u=!1,this.Yield(t.Current())):u?(u=!1,this.Yield(n)):!1},function(){r.Dispose(t)})})},Distinct:function(n){return this.Except(t.Empty(),n)},Except:function(n,e){e=r.CreateLambda(e);var u=this;return new t(function(){var o,a;return new i(function(){o=u.GetEnumerator(),a=new f(e),t.From(n).ForEach(function(t){a.Add(t)})},function(){for(;o.MoveNext();){var t=o.Current();if(!a.Contains(t))return a.Add(t),this.Yield(t)}return!1},function(){r.Dispose(o)})})},Intersect:function(n,e){e=r.CreateLambda(e);var u=this;return new t(function(){var o,a,s;return new i(function(){o=u.GetEnumerator(),a=new f(e),t.From(n).ForEach(function(t){a.Add(t)}),s=new f(e)},function(){for(;o.MoveNext();){var t=o.Current();if(!s.Contains(t)&&a.Contains(t))return s.Add(t),this.Yield(t)}return!1},function(){r.Dispose(o)})})},SequenceEqual:function(n,e){e=r.CreateLambda(e);var u=this.GetEnumerator();try{var i=t.From(n).GetEnumerator();try{for(;u.MoveNext();)if(!i.MoveNext()||e(u.Current())!==e(i.Current()))return!1;return i.MoveNext()?!1:!0}finally{r.Dispose(i)}}finally{r.Dispose(u)}},Union:function(n,e){e=r.CreateLambda(e);var u=this;return new t(function(){var o,a,s;return new i(function(){o=u.GetEnumerator(),s=new f(e)},function(){var e;if(void 0===a){for(;o.MoveNext();)if(e=o.Current(),!s.Contains(e))return s.Add(e),this.Yield(e);a=t.From(n).GetEnumerator()}for(;a.MoveNext();)if(e=a.Current(),!s.Contains(e))return s.Add(e),this.Yield(e);return!1},function(){try{r.Dispose(o)}finally{r.Dispose(a)}})})},OrderBy:function(t){return new a(this,t,!1)},OrderByDescending:function(t){return new a(this,t,!0)},Reverse:function(){var e=this;return new t(function(){var t,r;return new i(function(){t=e.ToArray(),r=t.length},function(){return r>0?this.Yield(t[--r]):!1},n.Blank)})},Shuffle:function(){var e=this;return new t(function(){var t;return new i(function(){t=e.ToArray()},function(){if(t.length>0){var n=Math.floor(Math.random()*t.length);return this.Yield(t.splice(n,1)[0])}return!1},n.Blank)})},GroupBy:function(n,e,u,o){var a=this;return n=r.CreateLambda(n),e=r.CreateLambda(e),null!=u&&(u=r.CreateLambda(u)),o=r.CreateLambda(o),new t(function(){var t;return new i(function(){t=a.ToLookup(n,e,o).ToEnumerable().GetEnumerator()},function(){for(;t.MoveNext();)return null==u?this.Yield(t.Current()):this.Yield(u(t.Current().Key(),t.Current()));return!1},function(){r.Dispose(t)})})},PartitionBy:function(n,e,u,o){var a=this;n=r.CreateLambda(n),e=r.CreateLambda(e),o=r.CreateLambda(o);var s;return null==u?(s=!1,u=function(t,n){return new h(t,n)}):(s=!0,u=r.CreateLambda(u)),new t(function(){var c,f,l,h=[];return new i(function(){c=a.GetEnumerator(),c.MoveNext()&&(f=n(c.Current()),l=o(f),h.push(e(c.Current())))},function(){for(var r;1==(r=c.MoveNext())&&l===o(n(c.Current()));)h.push(e(c.Current()));if(h.length>0){var i=s?u(f,t.From(h)):u(f,h);return r?(f=n(c.Current()),l=o(f),h=[e(c.Current())]):h=[],this.Yield(i)}return!1},function(){r.Dispose(c)})})},BufferWithCount:function(n){var e=this;return new t(function(){var t;return new i(function(){t=e.GetEnumerator()},function(){for(var e=[],r=0;t.MoveNext();)if(e.push(t.Current()),++r>=n)return this.Yield(e);return e.length>0?this.Yield(e):!1},function(){r.Dispose(t)})})},Aggregate:function(t,n,e){return this.Scan(t,n,e).Last()},Average:function(t){t=r.CreateLambda(t);var n=0,e=0;return this.ForEach(function(r){n+=t(r),++e}),n/e},Count:function(t){t=null==t?n.True:r.CreateLambda(t);var e=0;return this.ForEach(function(n,r){t(n,r)&&++e}),e},Max:function(t){return null==t&&(t=n.Identity),this.Select(t).Aggregate(function(t,n){return t>n?t:n})},Min:function(t){return null==t&&(t=n.Identity),this.Select(t).Aggregate(function(t,n){return n>t?t:n})},MaxBy:function(t){return t=r.CreateLambda(t),this.Aggregate(function(n,e){return t(n)>t(e)?n:e})},MinBy:function(t){return t=r.CreateLambda(t),this.Aggregate(function(n,e){return t(n)<t(e)?n:e})},Sum:function(t){return null==t&&(t=n.Identity),this.Select(t).Aggregate(0,function(t,n){return t+n})},ElementAt:function(t){var n,e=!1;if(this.ForEach(function(r,u){return u==t?(n=r,e=!0,!1):void 0}),!e)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return n},ElementAtOrDefault:function(t,n){var e,r=!1;return this.ForEach(function(n,u){return u==t?(e=n,r=!0,!1):void 0}),r?e:n},First:function(t){if(null!=t)return this.Where(t).First();var n,e=!1;if(this.ForEach(function(t){return n=t,e=!0,!1}),!e)throw new Error("First:No element satisfies the condition.");return n},FirstOrDefault:function(t,n){if(null!=n)return this.Where(n).FirstOrDefault(t);var e,r=!1;return this.ForEach(function(t){return e=t,r=!0,!1}),r?e:t},Last:function(t){if(null!=t)return this.Where(t).Last();var n,e=!1;if(this.ForEach(function(t){e=!0,n=t}),!e)throw new Error("Last:No element satisfies the condition.");return n},LastOrDefault:function(t,n){if(null!=n)return this.Where(n).LastOrDefault(t);var e,r=!1;return this.ForEach(function(t){r=!0,e=t}),r?e:t},Single:function(t){if(null!=t)return this.Where(t).Single();var n,e=!1;if(this.ForEach(function(t){if(e)throw new Error("Single:sequence contains more than one element.");e=!0,n=t}),!e)throw new Error("Single:No element satisfies the condition.");return n},SingleOrDefault:function(t,n){if(null!=n)return this.Where(n).SingleOrDefault(t);var e,r=!1;return this.ForEach(function(t){if(r)throw new Error("Single:sequence contains more than one element.");r=!0,e=t}),r?e:t},Skip:function(n){var e=this;return new t(function(){var t,u=0;return new i(function(){for(t=e.GetEnumerator();u++<n&&t.MoveNext(););},function(){return t.MoveNext()?this.Yield(t.Current()):!1},function(){r.Dispose(t)})})},SkipWhile:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t,u=0,o=!1;return new i(function(){t=e.GetEnumerator()},function(){for(;!o;){if(!t.MoveNext())return!1;if(!n(t.Current(),u++))return o=!0,this.Yield(t.Current())}return t.MoveNext()?this.Yield(t.Current()):!1},function(){r.Dispose(t)})})},Take:function(n){var e=this;return new t(function(){var t,u=0;return new i(function(){t=e.GetEnumerator()},function(){return u++<n&&t.MoveNext()?this.Yield(t.Current()):!1},function(){r.Dispose(t)})})},TakeWhile:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t,u=0;return new i(function(){t=e.GetEnumerator()},function(){return t.MoveNext()&&n(t.Current(),u++)?this.Yield(t.Current()):!1},function(){r.Dispose(t)})})},TakeExceptLast:function(n){null==n&&(n=1);var e=this;return new t(function(){if(0>=n)return e.GetEnumerator();var t,u=[];return new i(function(){t=e.GetEnumerator()},function(){for(;t.MoveNext();){if(u.length==n)return u.push(t.Current()),this.Yield(u.shift());u.push(t.Current())}return!1},function(){r.Dispose(t)})})},TakeFromLast:function(n){if(0>=n||null==n)return t.Empty();var e=this;return new t(function(){var u,o,a=[];return new i(function(){u=e.GetEnumerator()},function(){for(;u.MoveNext();)a.length==n&&a.shift(),a.push(u.Current());return null==o&&(o=t.From(a).GetEnumerator()),o.MoveNext()?this.Yield(o.Current()):!1},function(){r.Dispose(o)})})},IndexOf:function(t){var n=null;return this.ForEach(function(e,r){return e===t?(n=r,!0):void 0}),null!==n?n:-1},LastIndexOf:function(t){var n=-1;return this.ForEach(function(e,r){e===t&&(n=r)}),n},ToArray:function(){var t=[];return this.ForEach(function(n){t.push(n)}),t},ToLookup:function(t,n,e){t=r.CreateLambda(t),n=r.CreateLambda(n),e=r.CreateLambda(e);var u=new f(e);return this.ForEach(function(e){var r=t(e),i=n(e),o=u.Get(r);void 0!==o?o.push(i):u.Add(r,[i])}),new l(u)},ToObject:function(t,n){t=r.CreateLambda(t),n=r.CreateLambda(n);var e={};return this.ForEach(function(r){e[t(r)]=n(r)}),e},ToDictionary:function(t,n,e){t=r.CreateLambda(t),n=r.CreateLambda(n),e=r.CreateLambda(e);var u=new f(e);return this.ForEach(function(e){u.Add(t(e),n(e))}),u},ToJSON:function(t,n){return JSON.stringify(this.ToArray(),t,n)},ToString:function(t,e){return null==t&&(t=""),null==e&&(e=n.Identity),this.Select(e).ToArray().join(t)},Do:function(n){var e=this;return n=r.CreateLambda(n),new t(function(){var t,u=0;return new i(function(){t=e.GetEnumerator()},function(){return t.MoveNext()?(n(t.Current(),u++),this.Yield(t.Current())):!1},function(){r.Dispose(t)})})},ForEach:function(t){t=r.CreateLambda(t);var n=0,e=this.GetEnumerator();try{for(;e.MoveNext()&&t(e.Current(),n++)!==!1;);}finally{r.Dispose(e)}},Write:function(t,n){null==t&&(t=""),n=r.CreateLambda(n);var e=!0;this.ForEach(function(r){e?e=!1:document.write(t),document.write(n(r))})},WriteLine:function(t){t=r.CreateLambda(t),this.ForEach(function(n){document.write(t(n)),document.write("<br />")})},Force:function(){var t=this.GetEnumerator();try{for(;t.MoveNext(););}finally{r.Dispose(t)}},Let:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var u;return new i(function(){u=t.From(n(e)).GetEnumerator()},function(){return u.MoveNext()?this.Yield(u.Current()):!1},function(){r.Dispose(u)})})},Share:function(){var e,r=this;return new t(function(){return new i(function(){null==e&&(e=r.GetEnumerator())},function(){return e.MoveNext()?this.Yield(e.Current()):!1},n.Blank)})},MemoizeAll:function(){var e,r,u=this;return new t(function(){var t=-1;return new i(function(){null==r&&(r=u.GetEnumerator(),e=[])},function(){return t++,e.length<=t?r.MoveNext()?this.Yield(e[t]=r.Current()):!1:this.Yield(e[t])},n.Blank)})},Catch:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t;return new i(function(){t=e.GetEnumerator()},function(){try{return t.MoveNext()?this.Yield(t.Current()):!1}catch(e){return n(e),!1}},function(){r.Dispose(t)})})},Finally:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t;return new i(function(){t=e.GetEnumerator()},function(){return t.MoveNext()?this.Yield(t.Current()):!1},function(){try{r.Dispose(t)}finally{n()}})})},Trace:function(t,n){return null==t&&(t="Trace"),n=r.CreateLambda(n),this.Do(function(e){console.log(t,":",n(e))})}};var n={Identity:function(t){return t},True:function(){return!0},Blank:function(){}},e={Boolean:typeof!0,Number:"number",String:"string",Object:typeof{},Undefined:"undefined",Function:"function"},r={CreateLambda:function(t){if(null==t)return n.Identity;if(typeof t==e.String){if(""==t)return n.Identity;if(-1==t.indexOf("=>"))return new Function("$,$$,$$$,$$$$","return "+t);var r=t.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return new Function(r[1],"return "+r[2])}return t},IsIEnumerable:function(t){if(typeof Enumerator!=e.Undefined)try{return new Enumerator(t),!0}catch(n){}return!1},Compare:function(t,n){return t===n?0:t>n?1:-1},Dispose:function(t){null!=t&&t.Dispose()}},u={Before:0,Running:1,After:2},i=function(t,n,e){var r=new o,i=u.Before;this.Current=r.Current,this.MoveNext=function(){try{switch(i){case u.Before:i=u.Running,t();case u.Running:return n.apply(r)?!0:(this.Dispose(),!1);case u.After:return!1}}catch(e){throw this.Dispose(),e}},this.Dispose=function(){if(i==u.Running)try{e()}finally{i=u.After}}},o=function(){var t=null;this.Current=function(){return t},this.Yield=function(n){return t=n,!0}},a=function(t,n,e,u){this.source=t,this.keySelector=r.CreateLambda(n),this.descending=e,this.parent=u};a.prototype=new t,a.prototype.CreateOrderedEnumerable=function(t,n){return new a(this.source,t,n,this)},a.prototype.ThenBy=function(t){return this.CreateOrderedEnumerable(t,!1)},a.prototype.ThenByDescending=function(t){return this.CreateOrderedEnumerable(t,!0)},a.prototype.GetEnumerator=function(){var t,e,r=this,u=0;return new i(function(){t=[],e=[],r.source.ForEach(function(n,r){t.push(n),e.push(r)});var n=s.Create(r,null);n.GenerateKeys(t),e.sort(function(t,e){return n.Compare(t,e)})},function(){return u<e.length?this.Yield(t[e[u++]]):!1},n.Blank)};var s=function(t,n,e){this.keySelector=t,this.descending=n,this.child=e,this.keys=null};s.Create=function(t,n){var e=new s(t.keySelector,t.descending,n);return null!=t.parent?s.Create(t.parent,e):e},s.prototype.GenerateKeys=function(t){for(var n=t.length,e=this.keySelector,r=new Array(n),u=0;n>u;u++)r[u]=e(t[u]);this.keys=r,null!=this.child&&this.child.GenerateKeys(t)},s.prototype.Compare=function(t,n){var e=r.Compare(this.keys[t],this.keys[n]);if(0==e){if(null!=this.child)return this.child.Compare(t,n);e=r.Compare(t,n)}return this.descending?-e:e};var c=function(t){this.source=t};c.prototype=new t,c.prototype.Any=function(n){return null==n?this.source.length>0:t.prototype.Any.apply(this,arguments)},c.prototype.Count=function(n){return null==n?this.source.length:t.prototype.Count.apply(this,arguments)},c.prototype.ElementAt=function(n){return n>=0&&n<this.source.length?this.source[n]:t.prototype.ElementAt.apply(this,arguments)},c.prototype.ElementAtOrDefault=function(t,n){return t>=0&&t<this.source.length?this.source[t]:n},c.prototype.First=function(n){return null==n&&this.source.length>0?this.source[0]:t.prototype.First.apply(this,arguments)},c.prototype.FirstOrDefault=function(n,e){return null!=e?t.prototype.FirstOrDefault.apply(this,arguments):this.source.length>0?this.source[0]:n},c.prototype.Last=function(n){return null==n&&this.source.length>0?this.source[this.source.length-1]:t.prototype.Last.apply(this,arguments)},c.prototype.LastOrDefault=function(n,e){return null!=e?t.prototype.LastOrDefault.apply(this,arguments):this.source.length>0?this.source[this.source.length-1]:n},c.prototype.Skip=function(e){var r=this.source;return new t(function(){var t;return new i(function(){t=0>e?0:e},function(){return t<r.length?this.Yield(r[t++]):!1},n.Blank)})},c.prototype.TakeExceptLast=function(t){return null==t&&(t=1),this.Take(this.source.length-t)},c.prototype.TakeFromLast=function(t){return this.Skip(this.source.length-t)},c.prototype.Reverse=function(){var e=this.source;return new t(function(){var t;return new i(function(){t=e.length},function(){return t>0?this.Yield(e[--t]):!1},n.Blank)})},c.prototype.SequenceEqual=function(n,e){return(n instanceof c||n instanceof Array)&&null==e&&t.From(n).Count()!=this.Count()?!1:t.prototype.SequenceEqual.apply(this,arguments)},c.prototype.ToString=function(n,e){return null==e&&this.source instanceof Array?(null==n&&(n=""),this.source.join(n)):t.prototype.ToString.apply(this,arguments)},c.prototype.GetEnumerator=function(){var t=this.source,e=0;return new i(n.Blank,function(){return e<t.length?this.Yield(t[e++]):!1},n.Blank)};var f=function(){var r=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},u=function(t){return null===t?"null":void 0===t?"undefined":typeof t.toString===e.Function?t.toString():Object.prototype.toString.call(t)},o=function(t,n){this.Key=t,this.Value=n,this.Prev=null,this.Next=null},a=function(){this.First=null,this.Last=null};a.prototype={AddLast:function(t){null!=this.Last?(this.Last.Next=t,t.Prev=this.Last,this.Last=t):this.First=this.Last=t},Replace:function(t,n){null!=t.Prev?(t.Prev.Next=n,n.Prev=t.Prev):this.First=n,null!=t.Next?(t.Next.Prev=n,n.Next=t.Next):this.Last=n},Remove:function(t){null!=t.Prev?t.Prev.Next=t.Next:this.First=t.Next,null!=t.Next?t.Next.Prev=t.Prev:this.Last=t.Prev}};var s=function(t){this.count=0,this.entryList=new a,this.buckets={},this.compareSelector=null==t?n.Identity:t};return s.prototype={Add:function(t,n){var e=this.compareSelector(t),i=u(e),a=new o(t,n);if(r(this.buckets,i)){for(var s=this.buckets[i],c=0;c<s.length;c++)if(this.compareSelector(s[c].Key)===e)return this.entryList.Replace(s[c],a),void(s[c]=a);s.push(a)}else this.buckets[i]=[a];this.count++,this.entryList.AddLast(a)},Get:function(t){var n=this.compareSelector(t),e=u(n);if(!r(this.buckets,e))return void 0;for(var i=this.buckets[e],o=0;o<i.length;o++){var a=i[o];if(this.compareSelector(a.Key)===n)return a.Value}return void 0},Set:function(t,n){var e=this.compareSelector(t),i=u(e);if(r(this.buckets,i))for(var a=this.buckets[i],s=0;s<a.length;s++)if(this.compareSelector(a[s].Key)===e){var c=new o(t,n);return this.entryList.Replace(a[s],c),a[s]=c,!0}return!1},Contains:function(t){var n=this.compareSelector(t),e=u(n);if(!r(this.buckets,e))return!1;for(var i=this.buckets[e],o=0;o<i.length;o++)if(this.compareSelector(i[o].Key)===n)return!0;return!1},Clear:function(){this.count=0,this.buckets={},this.entryList=new a},Remove:function(t){var n=this.compareSelector(t),e=u(n);if(r(this.buckets,e))for(var i=this.buckets[e],o=0;o<i.length;o++)if(this.compareSelector(i[o].Key)===n)return this.entryList.Remove(i[o]),i.splice(o,1),0==i.length&&delete this.buckets[e],void this.count--},Count:function(){return this.count},ToEnumerable:function(){var e=this;return new t(function(){var t;return new i(function(){t=e.entryList.First},function(){if(null!=t){var n={Key:t.Key,Value:t.Value};return t=t.Next,this.Yield(n)}return!1},n.Blank)})}},s}(),l=function(n){this.Count=function(){return n.Count()},this.Get=function(e){return t.From(n.Get(e))},this.Contains=function(t){return n.Contains(t)},this.ToEnumerable=function(){return n.ToEnumerable().Select(function(t){return new h(t.Key,t.Value)})}},h=function(t,n){this.Key=function(){return t},c.call(this,n)};return h.prototype=new c,t}();