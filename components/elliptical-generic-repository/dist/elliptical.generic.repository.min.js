!function(t,r){"undefined"!=typeof module&&module.exports?module.exports=r(require("elliptical-lodash").c):"function"==typeof define&&define.amd?define(["elliptical-lodash"],r):(t.elliptical=t.elliptical||{},t.elliptical.GenericRepository=r(t._.c),t.returnExports=t.elliptical.GenericRepository)}(this,function(t){function r(t,r,e){var i=(t-1)*r,n=t*r-1;return n>e&&(n=e),{start:i,end:n}}function e(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function i(t){return t.charAt(0).toLowerCase()+t.slice(1)}function n(t){return t.substring(0,t.length-1)}function o(t){var r=t[0],e=r.split("."),o=[];e.forEach(function(t){t=i(t),o.push(t)});var s="";return o.forEach(function(t){s+=t+"."}),s=n(s),[s]}function s(r,e){return t.filter(r,function(t,r){return r>=e.start&&r<=e.end})}function u(r,e){return t.find(r,function(t){return t.id.toString().toLowerCase()===e.toString().toLowerCase()})}function a(r,e){return t.findIndex(r,function(t){return t.id.toString().toLowerCase()===e.toString().toLowerCase()})}function c(r,e,i){return i&&(e=o(e)),t.sortByOrder(r,e,["asc"])}function l(r,e,i){return i&&(e=o(e)),t.sortByOrder(r,e,["desc"])}function d(t,r){var e=a(t,r);return t.splice(e,1),t}function h(t,r){for(var e=0;e<r.length;e++){var i=r[e];d(t,i)}}function f(t,r,e){var i=u(t,r);for(var n in i)i.hasOwnProperty(n)&&void 0!==e[n]&&(i[n]=e[n])}function p(t,i){var n=arguments.length;if(0===n)throw"Generic Repository requires an array model passed in the constructor";"function"!=typeof i&&(i=null),this.model=t,this.callback=i,this.camelCaseSort=!0,this.get=function(t,r,e,i){r&&"object"==typeof r?(i=e,e=r):r&&"function"==typeof r&&(i=r,r=null);var n,o=this.model;return n=t&&t.id?u(o,t.id):e&&e.filter&&void 0!==e.filter?this.query(e.filter):o,e&&e.orderBy&&void 0!==e.orderBy&&(n=this.orderBy(n,e.orderBy)),e&&e.orderByDesc&&void 0!==e.orderByDesc&&(n=this.orderByDesc(n,e.orderByDesc)),e&&e.paginate&&(n=this.paginate(n,e.paginate)),this.callback?void this.callback(n,"get",t,i):i?i(null,n):n},this.post=function(t,r,i){var n=t;"string"!=typeof r&&(i=r);var o=this.model;return t.id||(t.id=e()),t=this._post(t),o.push(t),this.onChange(o),this.callback?void this.callback(t,"post",n,i):i?i(null,t):t},this.put=function(t,r,e){"string"!=typeof r&&(e=r);var i=this.model;return t=this._put(t),f(i,t.id,t),this.onChange(i),this.callback?void this.callback(t,"put",t,e):e?e(null,t):t},this["delete"]=function(r,e,i){return"string"!=typeof e&&(i=e),r.id?d(t,r.id):r.ids&&h(t,r.ids),this.onChange(t),this.callback?void this.callback(null,"delete",r,i):i?i(null,null):null},this.Enumerable=function(){return Enumerable.From(this.model)},this.query=function(t,r){return this.model},this.onChange=function(t){},this.orderBy=function(t,r){var e=[];return e.push(r),c(t,e,this.camelCaseSort)},this.orderByDesc=function(t,r){var e=[];return e.push(r),l(t,e,this.camelCaseSort)},this.paginate=function(t,e){var i=t.length,n=e.pageSize,o=e.page;o||(o=1);var u=r(o,n,i),a=s(t,u);return{data:a,count:i}},this._get=function(t,r,e){var i,n=this.model;return i=r&&r.filter&&void 0!==r.filter?this.query(r.filter):n,r&&r.orderBy&&void 0!==r.orderBy&&(i=this.orderBy(i,r.orderBy)),r&&r.orderByDesc&&void 0!==r.orderByDesc&&(i=this.orderByDesc(i,r.orderByDesc)),r&&r.paginate&&(i=this.paginate(i,r.paginate)),this.callback?void this.callback(i,"get",t,e):e?e(null,i):i},this._post=function(t){return t},this._put=function(t){return t}}return void 0!==t.c&&(t=t.c),p});