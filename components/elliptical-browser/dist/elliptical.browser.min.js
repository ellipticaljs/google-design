!function(){void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){var t=/function\s([^(]{1,})\(/,e=t.exec(this.toString());return e&&e.length>1?e[1].trim():""},set:function(t){}})}(),function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):(t.elliptical.delegate=t.elliptical.delegate||{},t.elliptical.delegate.request=e(),t.returnExports=t.elliptical.delegate.request)}(this,function(){var t="ontouchend"in document?"touchend":"click",e="OnDocumentRequest",i="a:not([data-route])",n=$(document),o=!1;return function(){function r(t){var i=$(t.currentTarget),o=i.attr("href");if(void 0!==o&&"#"!==o){var r=i.attr("data-propagation");r&&t.stopPropagation(),t.preventDefault();var l={method:"get",href:o};$.each(this.attributes,function(t,e){l[e.name.toCamelCase()]=e.value}),l.route=o,n.trigger(e,l)}}o||(o=!0,n.on(t,i,r))}}),function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("elliptical-document")):"function"==typeof define&&define.amd?define(["elliptical-document"],e):(t.elliptical.delegate=t.elliptical.delegate||{},t.elliptical.delegate.submit=e($),t.returnExports=t.elliptical.delegate.submit)}(this,function(t){var e="submit",i='form[role="form"]',n="OnDocumentRequest",o="OnDocumentSubmit",r=t(document),l=!1;return function(){function a(e){e.stopPropagation(),e.preventDefault();var i=t(e.currentTarget),l=i.document(),a={route:this.action,body:l,method:t(this).attr("method"),element:this};this.action&&""!==this.action&&r.trigger(n,a),r.trigger(o,a)}l||(l=!0,r.on(e,i,a))}}),function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("elliptical-utils"),require("elliptical-class"),require("elliptical-location"),require("elliptical-soa"),require("elliptical-utils")):"function"==typeof define&&define.amd?define(["elliptical-utils","elliptical-class","elliptical-location","elliptical-soa"],e):(t.elliptical.Request=e(t.elliptical.utils,t.elliptical.Class,t.elliptical,t.elliptical),t.returnExports=t.elliptical.Request)}(this,function(t,e,i,n){var o,r,l,a=i.Location,s=i.url,c=n.$Cookie,u=n.$Session;return l=e.extend({},{init:function(){this.params={},this.query={},this.body={},this.route={},this.files={},o=c.count(),r=u.count(),Object.defineProperties(this,{path:{get:function(){return a.path},configurable:!1},url:{get:function(){return a.href},configurable:!1},protocol:{get:function(){var t=a.protocol;return t=t.replace(":","")},configurable:!1},get:{get:function(t){return console.log('warning: "get" not implemented on the browser.'),!1},configurable:!1},accepted:{get:function(){return console.log('warning: "accepted" not implemented on the browser.'),!1},configurable:!1},accepts:{get:function(){return console.log('warning: "accepts" not implemented on the browser.'),!1},configurable:!1},is:{get:function(){return console.log('warning: "is" not implemented on the browser.'),!1},configurable:!1},xhr:{get:function(){return!0},configurable:!1},acceptsLanguage:{get:function(t){return console.log('warning: "acceptsLanguage" not implemented on the browser.'),!1},configurable:!1},acceptsCharset:{get:function(t){return console.log('warning: "acceptsLanguage" not implemented on the browser.'),!1},configurable:!1},acceptsCharsets:{get:function(){return!1},configurable:!1},acceptedLanguages:{get:function(){return!1},configurable:!1},originalUrl:{get:function(){return!1},configurable:!1},subdomains:{get:function(){return!1},configurable:!1},secure:{get:function(){return!1},configurable:!1},stale:{get:function(){return console.log('warning: "stale" not implemented on the browser.'),!1},configurable:!1},fresh:{get:function(){return console.log('warning: "fresh" not implemented on the browser.'),!1},configurable:!1},host:{get:function(){return window.location.hostname},configurable:!1},ip:{get:function(){},configurable:!1},ips:{get:function(){return console.log('warning: "ips" not implemented on the browser.'),!1},configurable:!1},signedCookies:{get:function(){return{}},configurable:!1}}),this.session={};for(var t=0;r>t;t++){var e=u.key(t);this.session[e]=u.get(e)}this.cookies={};for(var i=0;o>i;i++){var n=c.key(i);this.cookies[n]=c.get(n)}this._parsedUrl={},this._parsedUrl.pathname=a.path,this._parsedUrl.virtualize=function(t){var e=window.elliptical.$hashTag;return e&&(t=s.hashTagFormat(s)),t=s.pathComponent(t)},this.header=function(t){switch(t){case"Referer":return document.referrer}}}})}),function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("elliptical-utils"),require("elliptical-class"),require("elliptical-location"),require("elliptical-soa")):"function"==typeof define&&define.amd?define(["elliptical-utils","elliptical-class","elliptical-location","elliptical-soa"],e):(t.elliptical.Response=e(t.elliptical.utils,t.elliptical.Class,t.elliptical,t.elliptical),t.returnExports=t.elliptical.Response)}(this,function(t,e,i,n){var o,r=i.Location,l=n.$Cookie,a=n.$Session;return o=e.extend({req:{}},{init:function(t){this.req=t,this.charset={},this.context={},this.transition={},this.locals={},this.status=function(t){},this.set=function(t,e){},this.get=function(t){},this.cookie=function(t,e,i){l.set(t,e,i)},this.clearCookie=function(t,e){l["delete"](t)},this.redirect=function(t,e){"undefined"==typeof e&&(e=t),e=decodeURIComponent(e),r.redirect(e)},this.session=function(t,e){a.set(t,e)},this.location=function(t){},this.send=function(t,e){},this.json=function(t,e){},this.jsonp=function(t,e){},this.type=function(t){},this.format=function(t){},this.attachment=function(t){},this.sendfile=function(t,e,i){},this.download=function(t,e,i){},this.links=function(t){},this.scrollTop=function(t){void 0===t&&(t=100),setTimeout(function(){window.scrollTo(0,0)},t)},this.animateScrollTop=function(t){void 0===t&&(t=100),$.device.touch?setTimeout(function(){window.scrollTo(0,0)},100):$("html,body").animate({scrollTop:0},500)}},render:function(t,e,i,n){var o=this.req,r=void 0,l=void 0,a=null,s=null,c=arguments.length;if(0===c&&(r={name:o.__name,view:o.__action},l={}),1===c&&("string"==typeof t?(r=t,l={}):t instanceof Function?(s=t,r={name:o.__name,view:o.__action},l={}):(r={name:o.__name,view:o.__action},l=t)),2==c&&("object"==typeof t?(l=t,"string"==typeof e||null===e?r=e:e instanceof Function?(s=e,r={name:o.__name,view:o.__action}):(a=e,r={name:o.__name,view:o.__action})):(l={},r=t,e instanceof Function?s=e:a=e)),3==c&&("object"==typeof t?(l=t,"string"==typeof e||null==e?(r=e,i instanceof Function?s=i:a=i):(r={name:o.__name,view:o.__action},a=e,s=i)):(l={},r=t,s=i,a=e)),4===c&&(r=e,l=t,a=i,s=n),c>4)throw"View render does not support more than 4 parameters";if(r){if("string"==typeof r){var u=r.split(".");2===u.length?r={name:u[0],view:u[1]}:1===u.length&&(r={name:o.__name,view:r})}}else r={name:o.__name,view:o.__action};!s instanceof Function&&(s=null),this.app.render(l,r,a,o,s)},setContext:function(t){var e=this.req;e.session=e.session||{},Object.assign(e.session,t)},dispatch:function(t,e,i){t?e(t):i.apply(this,arguments)}})}),function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("async"),require("elliptical-utils"),require("elliptical-soa"),require("elliptical-event"),require("elliptical-location"),require("elliptical-view"),require("elliptical-template"),require("./request"),require("./response"),require("./delegate.request"),require("./delegate.submit")):"function"==typeof define&&define.amd?define(["async","elliptical-utils","elliptical-soa","elliptical-event","elliptical-location","elliptical-view","elliptical-template","./request","./response","./delegate.request","./delegate.submit"],e):(t.elliptical.application=e(t.async,t.elliptical.utils,t.elliptical,t.elliptical.Event,t.elliptical,t.elliptical.View,t.elliptical.$Template,t.elliptical.Request,t.elliptical.Response,t.elliptical.delegate.request,t.elliptical.delegate.submit),t.returnExports=t.elliptical.browser)}(this,function(t,e,i,n,o,r,l,a,s,c,u){var p=o.Router,f=o.Location,h=o.url,d=e.network,g=500,m="OnRouteDispatch",v="OnDocumentHistory",_="OnDocumentHistoryRequest",w="appRouter",b="production",y="development",q="data-environment",x="/",R="get",T="",E="html";return{init:function(){window.elliptical.$hashTag=!1,this.history=!1,this.contextSettings(),this.setEnvironment(),this.$setDefaultProviders(),this.cache={},this.stack=[],this.locations=[],this.Router=p,this._defineProps(),this._historyEventListener(),this.context={};var t=function(t){t.router=function(){t.next()},t.router.__name=w;var e=x,i=t.router;t.stack.push({route:e,handle:i})};t(this)},_defineProps:function(){this._debug=!1,this._virtualRoot=x,this._hashTag=!1,this.settings.siteTitle=T;var t=this;Object.defineProperties(this,{debug:{get:function(){return t._debug},set:function(e){p.debug=e,t._debug=e}},hashTag:{get:function(){return t._hashTag},set:function(e){p.hashTag=e,t._hashTag=e,window.elliptical.$hashTag=e}},virtualRoot:{get:function(){return t._virtualRoot},set:function(e){p.virtualRoot=e,t._virtualRoot=e,t.context.rootPath=e,window.elliptical.$virtualRoot=e}},siteRootTitle:{get:function(){return t.settings.siteTitle},set:function(e){t.settings.siteTitle=e}}})},$setDefaultProviders:function(){var t=i.Service;t.$paginationProvider=i.$Pagination,r.$provider=l},setEnvironment:function(t){function e(t){var e=$(E),i=e.attr(q);return"undefined"!=typeof i?(t.context.ENV=i.toLowerCase(),!0):!1}function i(t){var e=document.location.hostname;t.context.ENV=d.isLocalHost(e)?y:b}"undefined"!=typeof t?this.context.ENV=t.toLowerCase():e(this)||i(this)},getPort:function(){return void 0},getEnvironment:function(){return this.context.ENV},configure:function(t,e){"function"==typeof t?(e=t,e.call(this)):"string"==typeof t&&(t.toLowerCase()===b&&this.context.ENV===b?e.call(this):t.toLowerCase()===y&&this.context.ENV===y&&e.call(this))},config:function(){},get:function(t,e){p.get(t,e)},post:function(t,e){p.post(t,e)},put:function(t,e){p.put(t,e)},"delete":function(t,e){p["delete"](t,e)},contextSettings:function(){this.context={},this.context.virtualRoot=x,this.isServer=!1,this.isBrowser=!0,this.settings=this.settings||{},this.settings.config={cookie:{},session:{},providers:{}}},location:function(t,e){t.substring(0,1)!=x&&(t=x+t),"object"!=typeof e&&(e=[]);var i={path:t,exclude:e};this.locations.push(i)},parseRoute:function(t){return this.hashTag?h.hashTagFormat(t):t},onDispatchRequest:function(){var t=this;n.on(m,function(e){if(t.__cancelledRoute&&t.__route===e.route)t.__cancelledRoute=!1,t.__route=null;else{var i=e.route,n=e.handlers;t.dispatch(i,n)}})},use:function(t,e){var i=this.stack;if("string"!=typeof t&&(e=t,t="/"),"function"!=typeof e)return void(this.virtualRoot=t);if(e.__name&&e.__name===this.router.__name)for(var n=0;n<i.length;n++){var o=i[n].handle;if(o.__name&&o.__name===this.router.__name||0===o.length){i.splice(n,1);break}}try{if(0===e.length&&void 0===e.__name)return}catch(r){}i.push({route:t,handle:e})},dispatch:function(t,e){function i(t){return t.substring(0,1)!=x&&(t=x+t),t}function n(t,e,i){function n(l){var a=t[r++];"undefined"!=typeof a&&("undefined"!=typeof l?4===a.length?(e=o(e,a),i=o(i,a),a(l,e,i,n)):n(l):a.length<4?(e=o(e,a),i=o(i,a),a(e,i,n)):n())}var r=0;v.next=n,n()}function o(t,e){return t.__name=e.__name,t.__action=e.__action,t}t=i(t);for(var r=this.stack,l=[],c=0;c<r.length;c++){var u=r[c].handle;if(u.__name&&u.__name===this.router.__name)for(var f=0;f<e.length;f++)l.push(e[f]);else{var h=r[c].route,d=t.toLowerCase().indexOf(h);d>-1&&(t.length===h.length||t.substring(d+1,0)===x)&&l.push(r[c].handle)}}var g=new a;g.route=t;var m=new s(g),v=this;g.app=m.app=v,g.res=m,m.req=g,this.history&&(m.redirect=function(t){p.location(t,R,null)}),n(l,g,m)},server:function(t){},browser:function(t){t.call(this)},defaultMiddleware:function(t,e){},bootstrap:function(t,e,i){},listen:function(t,e){var i=this,n=null,o=arguments.length;0===o&&u(),1===o&&("function"==typeof t?(n=t,u()):this._start(t)),2===o&&(n=e,this._start(t)),n&&$(function(){setTimeout(function(){n.call(i)},g)})},start:function(){this._start(!0)},onHistory:function(t){var e=this;document.addEventListener(v,function(i){var n=i.detail;t.call(e,n)})},_start:function(t){if(!this.history){if(!t)return void u();this.history=!0,u(),c(),this._startHistory()}},_startHistory:function(){var t=this.getEnvironment();this.onDispatchRequest(),this._setLocationHistoryService(),t===b&&(p.debug=!1),p.start()},_startHistoryFromRequest:function(t,e){console.log("history started"),void 0==e&&(e={});var i=e.disableRedirectOnStart;this.history||(this.history=!0,i&&(p.History.redirectOnStart=!1),u(),this._startHistory())},_setLocationHistoryService:function(){f.redirect=function(t){p.location(t,R,null)},f.reload=function(){var t=f.href;p.location(t,R)}},_historyEventListener:function(){$(document).on(_,this._startHistoryFromRequest.bind(this))},render:function(t,e,i,n,o){function l(t){a(t);var n=$(p);d.render(e,t,function(t,e){if(f){var r=$.parseHTML(e,document,!0);n.append(r),o&&o instanceof Function&&o(null,e)}else u&&void 0!==u?d.transition(p,e,i,o):(n.html(e),o&&o instanceof Function&&o.call(this))})}function a(t){t?window.__viewData=t:window.__viewData||(window.__viewData={})}function s(t,e){return t.PageTitle?e.settings.siteTitle&&(t.PageTitle=e.settings.siteTitle+"-"+t.PageTitle):e.settings.siteTitle&&(t.PageTitle=e.settings.siteTitle),t}t=t||{};var c=this,u=null,p=null,f=!1,h=null;i&&void 0!==i&&(u=i.transition,p=i.selector,f=i.append,h=i.delay);var d=new r;try{Object.assign(t,c.context),n.session&&Object.assign(t,n.session)}catch(g){}t=s(t,c),t.rootPath&&t.rootPath===x&&(t.rootPath=""),p&&void 0!==p||(p=r.selector);var m=h&&void 0!==h?parseInt(h):0;"function"==typeof c.onBeforeRender?c.onBeforeRender(n,n.res,t,function(t){setTimeout(function(){l(t)},m)}):setTimeout(function(){l(t)},m)}}}),function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("elliptical-utils"),require("elliptical-soa"),require("elliptical-location"),require("elliptical-event"),require("elliptical-middleware"),require("elliptical-template"),require("elliptical-http"),require("elliptical-crypto"),require("./application"),require("./response"),require("./request")):"function"==typeof define&&define.amd?define(["elliptical-utils","elliptical-soa","elliptical-location","elliptical-event","elliptical-middleware","elliptical-http","elliptical-crypto","./application","./response","./request"],e):(t.elliptical.browser=e(t.elliptical.utils,t.elliptical,t.elliptical.Location,t.elliptical.Event,t.elliptical.middleware,t.elliptical.$Template,t.elliptical.http,t.elliptical.crypto,t.elliptical.application,t.elliptical.Response,t.elliptical.Request),t.returnExports=t.elliptical.browser)}(this,function(t,e,i,n,o,r,l,a,s,c,u){function p(){var t=function(){};return Object.assign(t,s),t.init(),t}var f=p;return f.Event=n,f.application=s,f.Response=c,f.Request=u,f.http=l,f.crypto=a,f.Location=location.Location,f.$Template=r,Object.assign(e,o),Object.assign(f,e),Object.assign(f,window.elliptical),Object.defineProperty(window,"elliptical",{get:function(){return f},set:function(t){f[t]=t},enumerable:!0,configurable:!0}),window.elliptical.$virtualRoot="/",f});