!function(n,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):(n.elliptical=n.elliptical||{},n.elliptical.DomEvent=t(),n.returnExports=n.elliptical.DomEvent)}(this,function(){function n(n,o){this._events=[],this._node=null,this._context=this,this._infiniteScrollOn=!1,this._scrollOn=!1,n&&void 0!==n&&void 0!==n.nodeName&&(this._node=$(n)),o&&void 0!==o&&(this._context=o),this.event=function(n,t,e,i){var o=this._context,s=arguments.length;2===s&&(i=t,t=n,n=this._node,e=null),3===s&&("string"==typeof n?(i=e,e=t,t=n,n=this._node):(i=e,e=null));var l={};l.element=n,l.event=t,l.selector=e,l.callback=i,this._events.push(l),e?n.on(t,e,function(){var n=[].slice.call(arguments);i&&i.apply(o,n)}):n.on(t,function(){var n=[].slice.call(arguments);i&&i.apply(o,n)})},this.unbind=function(){for(var n=this._events,t=n.length,e=0;t>e;e++){var i=n[e];i.selector?i.element.off(i.event,i.selector):i.element.off(i.event)}n.length=0},this.onScroll=function(n){if(!this._scrollOn){this._scrollOn=!0;var t=function(){n&&n(window.scrollY)},i=function(){window.requestAnimationFrame(t)};this.event($(window),e,i)}},this.scrollOff=function(){if(this._scrollOn){this._scrollOn=!1;for(var n=this._events,t=n.length,i=0;t>i;i++){var o=n[i];if(o.event===e){o.selector?o.element.off(o.event,o.selector):o.element.off(o.event),n.splice(i);break}}}},this.onInfiniteScroll=function(n,e){if("function"==typeof n&&(e=n,n=i),!this._infiniteScrollOn){this._infiniteScrollOn=!0;var o=function(){var t=$(document).height()-$(window).height();$(window).scrollTop()>t-n&&e&&e()},s=function(){window.requestAnimationFrame(o)};this.event($(window),t,s)}},this.infiniteScrollOff=function(){if(this._scrollOn){this._scrollOn=!1;for(var n=this._events,e=n.length,i=0;e>i;i++){var o=n[i];if(o.event===t){o.selector?o.element.off(o.event,o.selector):o.element.off(o.event),n.splice(i);break}}}},this.register=function(n){var t=this;n.length&&n.forEach(function(n){t._isRegistered(n)||document.registerElement(n)})},this.load=function(n,t){var e=new Image,i=$(e);i.bind("load.newImg",function(){i.unbind("load.newImg"),t&&t(this)}),e.src=n},this.preload=function(n,t){"function"==typeof n&&(t=n,n=this._node);var e=[],i={},o=$(n),s=o.find("img"),l=s.length,c=0;return 0===l?(t&&t(null),!1):($.each(s,function(n,o){var s=new Image,r=$(s);r.bind("load.image",function(n){c++,e.push(s),r.unbind("load.image"),c===l&&t&&(i.images=e,i.length=c,t(i))}),s.src=o.src}),!0)},this.find=function(n){return this._node?this._node.find(n):null},this.dispose=function(){this.unbind(),this.scrollOff()},this._click=function(){return"ontouchend"in document?"touchstart":"click"},this._press=function(){return"ontouchend"in document?"touchend":"click"},this._tap=function(){return"ontouchend"in document?"tap":"click"},this._getEvent=function(n){return"click"===n?this._click():"press"===n?this._press():"tap"===n?this._tap():n},this._bindEvent=function(n,t){var e,i=this._node,o=n[t],s=t.split("@"),l=s.length;if(1===l)e=this._getEvent(s[0]),this.event(i,e,o);else if(2===l){var c=s[0];e=this._getEvent(s[1]),"document"===c&&this.event($(document),e,o),"window"===c?this.event($(window),e,o):this.event(i,e,c,o)}},this._isRegistered=function(n){return document.createElement(n).constructor!==HTMLElement}}var t="scroll.infinite",e="scroll.top",i=100;return n});